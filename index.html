<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mateus Bueno Site</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden; /* Prevent scrolling */
        }

        #info-container {
            font-family: 'Roboto', sans-serif;
            position: fixed;
            top: 10%;
            left: 10%;
            background-color: rgba(255, 255, 255, 0.8); /* Slightly transparent white background */
            padding: 30px; /* Adjust the padding for a larger container */
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* Soft shadow effect */
        }

        #content-description {
            display: none;
            position: fixed;
            top: 60%;
            left: 40%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        #content-text {
            font-size: 16px; /* Set the desired font size for the text */
            max-height: 200px; /* Set the maximum height for the text container */
            color: #333; /* Dark gray text color */
            text-shadow: 1px 1px 1px rgba(255, 255, 255, 0.5); /* Light text shadow */
            overflow-y: auto; /* Add a vertical scrollbar if the content exceeds the height */
        }

        h1, h2 {
            margin: 0;
            color: #333; /* Dark gray text color */
            text-shadow: 1px 1px 1px rgba(255, 255, 255, 0.5); /* Light text shadow */
        }

        button {
            display: block;
            margin-top: 15px; /* Adjust the margin for larger spacing between buttons */
            padding: 10px; /* Adjust the padding for larger buttons */
            border: none;
            border-radius: 5px;
            background-color: #3498db;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.3s, box-shadow 0.3s;
            box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.3); /* Button shadow */
        }

        button:hover {
            background-color: #2980b9;
            box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5); /* Larger shadow on hover */
        }

        #loading-spinner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #3498db; /* Loading spinner color */
        }

        #loading-spinner:before {
            content: '\2022 \2022 \2022'; /* Loading spinner dots */
            animation: loading 1.5s infinite linear;
        }

        @keyframes loading {
            0% {
                content: '\2022 \2022 \2022';
            }
            33% {
                content: '\2022 \2022 .';
            }
            66% {
                content: '\2022 . .';
            }
            100% {
                content: '. . .';
            }
        }
        #info-container {
            display: none; /* Hide initially */
        }
    </style>
</head>
<body>
    <div id="info-container">
        <h1>Mateus Bueno</h1>
        <h2>Software Engineer</h2>
        <button id="about-me-btn">Who am I</button>
        <button id="experience-btn">Experience</button>
        <button id="education-btn">Education</button>
        <button id="highlights-btn">Highlights</button>
    </div>
    <div id="content-description">
        <h1 id="content-title"></h1>
        <div id="content-text">
            <p>Paragraph 1 text goes here.</p>
            <p>Paragraph 2 text goes here.</p>
        </div>
        <button id="close-btn">Close</button>
    </div>
<script id="fireflies-vertex-shader" type="x-shader">
    uniform float uPixelRatio;
    uniform float uSize;
    attribute float aScale;
    uniform float uTime;
    void main()
    {
        vec4 modelPosition = modelMatrix * vec4(position, 1.0);
        modelPosition.y += sin(uTime + modelPosition.x * 100.0) * aScale * 0.8;
        vec4 viewPosition = viewMatrix * modelPosition;
        vec4 projectionPosition = projectionMatrix * viewPosition;

        gl_Position = projectionPosition;
        gl_PointSize = uSize * aScale * uPixelRatio;
        gl_PointSize *= (1.0 / - viewPosition.z);
    }
</script>

<script id="fireflies-fragment-shader" type="x-shader">
    void main()
    {
        float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
        float strength = 0.05 / distanceToCenter - 0.1;
    
        gl_FragColor = vec4(1.0, 1.0, 1.0, strength);
    }
</script>

<script type="module">
    import * as THREE from 'https://cdn.skypack.dev/three@0.129.0/build/three.module.js';
    import { OrbitControls } from 'https://cdn.skypack.dev/three@0.129.0/examples/jsm/controls/OrbitControls.js';
    import { GLTFLoader } from 'https://cdn.skypack.dev/three@0.129.0/examples/jsm/loaders/GLTFLoader.js';
    const firefliesVertexShader = document.getElementById('fireflies-vertex-shader').textContent;
    const firefliesFragmentShader = document.getElementById('fireflies-fragment-shader').textContent;

    // Create scene
    const scene = new THREE.Scene();

    // Create camera
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.x = 9
    camera.position.y = 12;
    camera.position.z = 25;

    // Create renderer with global illumination (ambient light)
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.BasicShadowMap;
    document.body.appendChild(renderer.domElement);

    const hemiLight = new THREE.HemisphereLight(0xffffe0, 0x080820, 0.7); // Warm yellowish color
    hemiLight.position.set(0, 5, 0); // Adjust the position if needed
    scene.add(hemiLight);

    // Load GLB model
    const loader = new GLTFLoader();
    const mixers = [];
    loader.load('./assets/site.glb', (gltf) => {
        const model = gltf.scene;
        model.traverse((child) => {
        if (child.isMesh) {
                child.castShadow = true;
                child.receiveShadow = true;
            }
        });
        const pointLight = new THREE.PointLight(0xffffff, 0.8);
        pointLight.position.set(4.5, 9, 8);
        pointLight.target = model;

        const pointLightBat = new THREE.PointLight(0xffffff, 1);
        pointLightBat.position.set(0.1, 9.8, 4.8);
        pointLightBat.target = model;

        const pointLightPotions = new THREE.PointLight(0xffffff, 0.8);
        pointLightPotions.position.set(-5, 3, 3);
        pointLightPotions.target = model;

        scene.add(pointLight);
        scene.add(pointLightBat);
        scene.add(pointLightPotions);

        // Check if there is at least one animation
        if (gltf.animations && gltf.animations.length > 0) {
            const mixer = new THREE.AnimationMixer(model);
            const clip = gltf.animations[0];

            const action = mixer.clipAction(clip);
            action.play();
            action.loop = THREE.LoopRepeat;

            scene.add(model);
            mixers.push(mixer);
        } else {
            console.error('No animations found in the GLTF file.');
        }
        document.getElementById('loading-spinner').style.display = 'none';

    	document.getElementById('info-container').style.display = 'block';
    });


    const skyGeometry = new THREE.SphereGeometry(100, 32, 32);
    const skyMaterial = new THREE.MeshBasicMaterial({
        color: 0x000011,
        side: THREE.BackSide, // Render the material on the back side of the geometry
    });
    const nightSky = new THREE.Mesh(skyGeometry, skyMaterial);
    scene.add(nightSky);

    // Create random stars using circles
    const numberOfStars = 200;
    const starsGeometry = new THREE.BufferGeometry();
    const starsVertices = [];

    for (let i = 0; i < numberOfStars; i++) {
        const x = (Math.random() - 0.5) * 200;
        const y = (Math.random() - 0.5) * 200;
        const z = (Math.random() - 0.5) * 200;

        starsVertices.push(x, y, z);
    }

    starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));

    const starsMaterial = new THREE.PointsMaterial({
        color: 0xffffff,
        size: 0.2,
        sizeAttenuation: false, // Disable size attenuation based on distance
    });
    const stars = new THREE.Points(starsGeometry, starsMaterial);
    scene.add(stars);

    const firefliesGeometry = new THREE.BufferGeometry()
    const firefliesCount = 50
    const positionArray = new Float32Array(firefliesCount * 3)
    const scaleArray = new Float32Array(firefliesCount)
    const firefliesMaterial = new THREE.ShaderMaterial({
        depthWrite: false,
        blending: THREE.AdditiveBlending,
        transparent: true,
        uniforms:
        {
            uTime: { value: 0 },
            uPixelRatio: { value: Math.min(window.devicePixelRatio, 2) },
            uSize: { value: 500 }
        },
        vertexShader: firefliesVertexShader,
        fragmentShader: firefliesFragmentShader
    })
    const clock = new THREE.Clock()
    const fireflies = new THREE.Points(firefliesGeometry, firefliesMaterial)
    scene.add(fireflies)

    for(let i = 0; i < firefliesCount; i++)
    {
        positionArray[i * 3 + 0] = (Math.random() - 0.5) * 30
        positionArray[i * 3 + 1] = Math.random() * 1.5 * 8
        positionArray[i * 3 + 2] = (Math.random() - 0.5) * 30
        scaleArray[i] = Math.random()
    }

    firefliesGeometry.setAttribute('position', new THREE.BufferAttribute(positionArray, 3))
    firefliesGeometry.setAttribute('aScale', new THREE.BufferAttribute(scaleArray, 1))

    const fogColor = new THREE.Color(0xffffe0); // Set the color of the fog
    const fogNear = 5; // Set the near distance of the fog
    const fogFar = 50; // Set the far distance of the fog

    
    const fog = new THREE.FogExp2(fogColor, 0.003); // Alternatively, you can use FogExp2 for an exponential fog effect

    scene.fog = fog;


    // Add orbit controls
    const controls = new OrbitControls(camera, renderer.domElement);
    let controlsEnabled = true;

    // Animation loop
    const animate = () => {
        requestAnimationFrame(animate);
        TWEEN.update();

        mixers.forEach((mixer) => {
            mixer.update(0.03);  // Adjust the time scale as needed
        });

        if (controlsEnabled) {
            // Only update controls if they are enabled
            controls.update();
        }
        const elapsedTime = clock.getElapsedTime()

        firefliesMaterial.uniforms.uTime.value = elapsedTime

        // Render scene
        renderer.render(scene, camera);
    };

    // Handle window resize
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
        firefliesMaterial.uniforms.uPixelRatio.value = Math.min(window.devicePixelRatio, 2)
    });
    const contentDescription = document.getElementById('content-description');
    const contentTitle = document.getElementById('content-title');
    const contentText = document.getElementById('content-text');
    const closeBtn = document.getElementById('close-btn');
    document.getElementById('about-me-btn').addEventListener('click', function () {
        moveToCoordinates(7, 10, 18, 1000);
        showContentDescription(
            'About Me',
            [
                "I'm a Software Engineer with experience in fullstack web development, using mainly Python, NodeJs and React JS.",
                "I am always aiming to explore new paths with cutting-edge technologies and to mix web applications with 3D,",
                "Machine Learning, Virtual/Augmented Reality and Cloud Computing.",
                'Contact me:',
                '<a href="https://www.linkedin.com/in/mateusmb/" target="_blank">linkedin.com/in/mateusmb</a>',
                '<a href="https://twitter.com/magus_64" target="_blank">twitter.com/@magus_64</a>',
                '<a href="https://bsky.app/profile/magus64.bsky.social" target="_blank">@magus64.bsky.social</a>',
                '<a href="https://github.com/mateusmb" target="_blank">github.com/mateusmb</a>',
            ]
        );
    });

    document.getElementById('experience-btn').addEventListener('click', function () {
        moveToCoordinates(-10, 3, -0.5, 1000);
        showContentDescription(
            'Experience',
            [
                '- Senior Software Engineer at Avaaz.org (Jan/2023 - Current) - Architecturing solutions and leading the development team to deliver products that helps millions of activists around the world. - Python, JavaScript, AWS, Team Leadership.', 
                '- Freelancer Consultant Engineer (Nov/2021 - Current) - Developing immersive applications and edugames for the Web, Mobile and Virtual Reality headsets - THREEjs, Unity, Unreal Engine.', 
                '- Software Engineer at BairesDev (May/2022 - Jan/2023) - Worked with NextRoll, a leading social media advertising management company, developing the core application of the main product, which manages the Ads image and video assets, with integrations to Facebook, Instagram, Tik Tok and Pinterest - Python, ReactJs, AWS.',
                '- Software Engineer at VoyagerPortal (Dec/2021 - Apr/2022) - Development and support for Voyager Portal, a voyage management platform, which powers maritime supply chain and shipping companies. - Python, Node.js, Vue.js, AWS.',
                '- Research Software Engineer at Senior Sistemas (Jul/2020 - Dec/2021) - Research in applied development and software engineering, to create and/or improve existing systems at Senior S.A, a leader company at Brazil on segments such as Enterprise Resource Planning, Human Resources, Customer Relationship Management and Logistics. As a researcher, my tasks involved implementing modern technologies to existing products or to prototype new applications with disruptive technology to new opportunities. - Python, Machine Learning, JavaScript, Node.js, React.js, AWS, Golang, Blockchain.',
                '- I.T. Coordinator at IFC (Apr/2017 - Jul/2020)- I coordinated a team of support and development of educational applications and I.T. infrastructure. My main responsiblities were management of virtualization, servers systems and leading the development of applications for students and professors at the institute. - Python, Django, JavaScript, Node.js, Linux, Team Leadership.',
                '- Information Technology Specialist at IFC (Mar/2013 - Jul/2020) - I started in a support role and eventually developed applications to support administration and educational tasks at the institute. I had to configure and maintain Linux Servers, Firewall systems, Authorization and Authentication systems with OpenLDAP and FreeRadius; designed network cabling infrastructure, support users in configure workstations and devices and developed web applications for course selection proccess and a system for managing students enter and exit of the institute facilities. - Python, Flask, Django, JavaScript.',
                '- Chief Technology Officer - I held a CTO position in a startup for Night Life Management, which was based at the city of Florianopolis. The main product of the startup was a mobile app, for Android and iOS, which offered a subscription program for night clubs VIP access and discounts on parties products. We had a maximum of circa 500 users, in the peak of the company life. The app was developed by myself with the MERN stack (MongoDB, ExpressJs, React Native and NodeJs). The company was eventually merged with another startup and migrated to a consulting business platform.'
            ]
        );
    });

    document.getElementById('education-btn').addEventListener('click', function () {
        moveToCoordinates(10, 3, 0.5, 1000);
        showContentDescription(
            'Education',
            [
                'Post graduation in Game Design at Unileya: 2022 - 2024',
                'Associate Degree in Systems Analysis and Development at IFC: 2013-2019',
                'Technical High School Diploma in Information Technology at IFSC: 2011-2012',
            ]
        );
    });

    document.getElementById('highlights-btn').addEventListener('click', function () {
        moveToCoordinates(1, 5, -10, 1000);
        showContentDescription(
            'Highlights',
            [
                '<a href="https://github.com/mateusmb/metaverse-tavern" target="_blank">A VR ambient with audio and multiplayer support</a>',
                '<a href="https://youtu.be/Hf2WV0nufFw" target="_blank">A event room on Altspace VR Metaverse</a>',
                '<a href="https://github.com/mateusmb/ar-face-tracking/" target="_blank">A virtual try on for AR glasses on real time</a>',
                '<a href="https://github.com/mateusmb/ar-image-tracking" target="_blank">An AR product display with Image Tracking</a>',
                '<a href="https://youtu.be/0HhWIvPhbu0?t=10985" target="_blank">A talk at React Global Online Summit 2021 about React and MediaPipe: Powering Web Applications with AI and Computer Vision</a>',
            ]
        );
    });

    closeBtn.addEventListener('click', hideContentDescription);

    // Function to smoothly move the camera to specific coordinates
    function moveToCoordinates(x, y, z, zoomFactor, duration) {
        const targetPosition = new THREE.Vector3(x, y, z);

        new TWEEN.Tween(camera.position)
            .to(targetPosition, duration)
            .onUpdate(() => {
                controls.update();
            })
            .onComplete(() => {
                // Enable controls once the animation is complete
                controlsEnabled = true;
            })
            .start();
                

    }

    function showContentDescription(title, paragraphs) {
        contentTitle.textContent = title;

        // Clear existing paragraphs
        contentText.innerHTML = '';

        // Create and append new paragraphs
        paragraphs.forEach((paragraphHTML) => {
            const paragraphElement = document.createElement('p');
            paragraphElement.innerHTML = paragraphHTML;
            contentText.appendChild(paragraphElement);
        });

        contentDescription.style.display = 'block';

        // Set initial opacity to 0
        contentDescription.style.opacity = 0;

        // Use Tween.js to animate opacity to 1 (fade-in effect)
        new TWEEN.Tween({ opacity: 0 })
            .to({ opacity: 1 }, 500)  // Set the duration (in milliseconds)
            .onUpdate((tween) => {
                contentDescription.style.opacity = tween.opacity;
            })
            .start();
    }

    // Function to hide content description
    function hideContentDescription() {
        contentDescription.style.display = 'none';
        new TWEEN.Tween({ opacity: 1 })
        .to({ opacity: 0 }, 500)  // Set the duration (in milliseconds)
        .onUpdate((tween) => {
            contentDescription.style.opacity = tween.opacity;
        })
        .onComplete(() => {
            // Hide the content description after the animation completes
            contentDescription.style.display = 'none';
        })
        .start();
    }

    // Start animation loop
    animate();
</script>

</body>
</html>